#
# Copyright (c) 2023 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

menuconfig SUIT_STREAM
        bool "Enable SUIT stream module"
        depends on SUIT_UTILS

if SUIT_STREAM

config SUIT_STREAM_SINK_CACHE
        bool "Enable SUIT cache sink"
        depends on SUIT_CACHE_RW

config SUIT_STREAM_SINK_MEMPTR
        bool "Enable memory pointer storage sink"
        depends on SUIT_MEMPTR_STORAGE

config SUIT_STREAM_SINK_MRAM
        bool "Enable NVM storage sink"
        depends on FLASH
        depends on SUIT_UTILS

config SUIT_STREAM_SINK_RAM
        bool "Enable RAM buffer sink"

menuconfig SUIT_STREAM_SINK_SDFW
  bool "Enable SDFW sink"
  depends on SOC_NRF54H20
  depends on !HW_REVISION_SOC1
  default y if IS_SECURE_DOMAIN_FW
  select PSA_WANT_ALG_SHA_512
  select SUIT_STREAM_SINK_DIGEST

if SUIT_STREAM_SINK_SDFW

config SUIT_SDFW_UPDATE_SIGNED_MANIFEST_OFFSET
  hex "Offset between start of the SDFW update candidate image and Signed Manifest section"
  default 0

config SUIT_SDFW_UPDATE_DIGEST_OFFSET
  hex "Offset between start of the SDFW update candidate image and SM.TBS.FW.DIGEST section"
  default 0x20

config SUIT_SDFW_UPDATE_PUBLIC_KEY_OFFSET
  hex "Offset between start of the SDFW update candidate image and Public Key section"
  default 0x100

config SUIT_SDFW_UPDATE_SIGNATURE_OFFSET
  hex "Offset between start of the SDFW update candidate image and Signature section"
  default 0x120

config SUIT_SDFW_UPDATE_FIRMWARE_OFFSET
  hex "Offset between start of the SDFW update candidate image and Firmware section"
  default 0x160

config SUIT_SDFW_UPDATE_MAX_SIZE
  hex "Maximum size of SDFW update"
  range 0x00000080 0x000FD000
  default 0x000FD000
  help
    Range is based on documentation of register UROT.SM.TBS.LAYOUT.USLOT.MAX

endif # SUIT_STREAM_SINK_SDFW

config SUIT_STREAM_SINK_DIGEST
  bool "Enable digest sink"
  select PSA_WANT_ALG_SHA_256 if SOC_FAMILY_NRF

if SUIT_STREAM_SINK_DIGEST
  config SUIT_STREAM_SINK_DIGEST_CONTEXT_COUNT
  int "Maximum number of contexts"
  default 1
endif # SUIT_STREAM_SINK_DIGEST

config SUIT_STREAM_SOURCE_CACHE
  bool "Enable SUIT cache source"
  depends on SUIT_CACHE

config SUIT_STREAM_SOURCE_MEMPTR
  bool "Enable memory pointer storage source"

endif # SUIT_STREAM
